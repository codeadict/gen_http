[
    {elvis, [
        {verbose, true},
        {config, [
            #{
                dirs => ["src"],
                filter => "*.erl",
                ruleset => erl_files,
                rules => [
                    {elvis_text_style, line_length, #{limit => 120, skip_comments => false}},
                    %% Increase DRY threshold to allow small justified duplications (e.g., error formatting)
                    {elvis_style, dont_repeat_yourself, #{min_complexity => 20}},
                    %% Disable invalid_dynamic_call - we use gen_http_transport behavior pattern
                    {elvis_style, invalid_dynamic_call, disable},
                    %% Disable no_throw for parser modules that use throw for error handling
                    {elvis_style, no_throw, disable},
                    %% Allow single-clause case for guard-heavy code
                    {elvis_style, no_single_clause_case, disable},
                    %% Allow deeper nesting for complex fallback logic in parser modules
                    {elvis_style, nesting_level, #{level => 5}},
                    %% Allow records in specs for parser modules - records are the domain model
                    {elvis_style, no_spec_with_records, disable},
                    %% Disable private_data_types - conn/request_state/context types must be exported
                    %% for unified API but cannot be opaque (need pattern matching on record names)
                    {elvis_style, private_data_types, disable}
                ]
            },
            #{
                dirs => ["."],
                filter => "elvis.config",
                ruleset => elvis_config
            },
            #{
                dirs => ["."],
                filter => "rebar.config",
                ruleset => rebar_config
            }
        ]}
    ]}
].
